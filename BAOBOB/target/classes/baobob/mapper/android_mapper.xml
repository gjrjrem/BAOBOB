<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="spring.mvc.baobob.android.persistence.AndroidDAO">

	<!-- 영화 예매 건수 -->
	<select id="getUseMovieCnt" resultType="int">
		SELECT COUNT(*)
		FROM movie_history_tbl mh, history_tbl ht
		WHERE mh.history_index = ht.history_index
			AND ht.member_id = #{id}
	</select>
	
	<!-- 식당 예매 건수 -->
	<select id="getUseRestaurantCnt" resultType="int">
		SELECT COUNT(*)
		FROM restaurant_history_tbl rh, history_tbl ht
		WHERE rh.history_index = ht.history_index
			AND ht.member_id = #{id}
	</select>
	
	<!-- 주차 이용 건수 -->
	<select id="getUseParkingCnt" resultType="int">
		SELECT COUNT(*)
		FROM park_history_tbl ph, history_tbl ht
		WHERE ph.history_index = ht.history_index
			AND ht.member_id = #{id}
	</select>

	<!-- 문의 내역(1:1, 분실물) -->
	<select id="getBoardList" resultType="spring.mvc.baobob.vo.BoardVO">
		<![CDATA[
		SELECT board_type, board_subject, board_content
		FROM board_tbl
		WHERE member_id = #{id}
		    AND board_type IN (2, 3)
		    AND	TO_CHAR(board_reg_date, 'DDD') >= TO_CHAR(SYSTIMESTAMP - 10, 'DDD')
		]]>
	</select>
</mapper>