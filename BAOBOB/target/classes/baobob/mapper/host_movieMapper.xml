<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="spring.mvc.baobob.host_movie.persistence.Host_movieDAO">
	
	<!-- 영화 갯수 구하기 getMovieCnt -->
	<select id="getMovieCnt" resultType="int">
		SELECT count(*) FROM movie_tbl
	</select>
	
	<!-- 영화 전체 목록 조회(개봉일 순) getMovieList -->
	<select id="getMovieList" resultType="spring.mvc.baobob.vo.MovieVO">
		<![CDATA[
		SELECT * 
	       FROM (
	       		 SELECT movie_index, movie_title, movie_content, movie_janre, movie_age, 
	       		 		movie_rel_date, movie_director, movie_star, movie_country, 
	       		 		movie_runTime, movie_poster, movie_trailer, movie_state, rownum rNum 
		 		  FROM ( 
		 		  		  SELECT * FROM movie_tbl
		 		  		   ORDER BY movie_index DESC
		 		  	    ) 
		 		)  
		  WHERE rNum >= #{start} AND rNum <= #{end} 
		]]>
	</select>
	
	<!-- 영화 추가 처리 hostMovieAddPro -->
	<insert id="hostMovieAddPro" parameterType="spring.mvc.baobob.vo.MovieVO">
		INSERT INTO movie_tbl (movie_index, movie_title, movie_content, movie_janre, movie_age, movie_rel_date, movie_director, movie_star, movie_country, movie_runTime, movie_poster, movie_trailer, movie_state) 
		VALUES (movie_tbl_SEQ.NEXTVAL, #{movie_title}, #{movie_content}, #{movie_janre}, #{movie_age}, #{movie_rel_date}, #{movie_director}, #{movie_star}, #{movie_country}, #{movie_runTime}, #{movie_poster}, #{movie_trailer}, #{movie_state})
	</insert>

	<!-- 영화 삭제 처리 hostMovieDel -->
	<delete id="hostMovieDel" parameterType="int">
		DELETE movie_tbl WHERE movie_index = #{movie_index}
	</delete>
	
	<!-- 영화 상세 hostMovieDetail -->
	<select id="hostMovieDetail" resultType="spring.mvc.baobob.vo.MovieVO">
		SELECT * FROM movie_tbl WHERE movie_index=#{movie_index}
	</select>
	
	<!-- 영화 수정 처리 hostMovieModPro -->
	<update id="hostMovieModPro" parameterType="spring.mvc.baobob.vo.MovieVO">
		UPDATE movie_tbl 
		SET movie_title=#{movie_title}, movie_content=#{movie_content}, movie_janre=#{movie_janre}, 
		    movie_age=#{movie_age}, movie_rel_date=#{movie_rel_date}, movie_director=#{movie_director}, 
		    movie_star=#{movie_star}, movie_country=#{movie_country}, movie_runTime=#{movie_runTime}, 
		    movie_poster=#{movie_poster}, movie_trailer=#{movie_trailer}, movie_state=#{movie_state} 
	 	WHERE movie_index=#{movie_index}
	</update>
</mapper>